FireFly 2.0.0
=============

New features
------------

 * MPI

 * Logger

 * Interpolation over a fixed number of primes

 * Factor scan

 * Amplitude parser

Changes
-------

 * CRTP + FFVec + dynamical bunches

 * Parser can find same functions

 * Writing of saved states improved (single threaded to be done)

 * CMake searching for GMP, Flint, ...

 * C++-14

 * 300 primes

 * O3 -> 02

 * Improved scheduling in first prime

 * Can handle empty bbs

Bug fixes
---------

* None :)


FireFly 1.3.5
=============

Bug fixes
---------

 * Fixed FFInt::pow yielding a wrong result for powers close to the prime number
 in the default implementation of FFInt. We thank Herschel Chawdhry for the bug
 report.


FireFly 1.3.4
=============

Bug fixes
---------

 * When a `PolynomialFF` object contained more than 50 monomials and was altered
 to contain less than 50 monomials, the corresponding Horner form was not
 re-evaluated, thus leading to false evaluations. This has been fixed.


FireFly 1.3.3
=============

Changes
---------

 * Updated PDF.

 * Fixed typos in README.md.

 * Now setting the correct paths to gmp and flint in cmake.

 * Included all necessary flags and paths in firefly.pc.

 * Changed the include path in firefly.pc from ../include/firefly to ../include.


FireFly 1.3.2
=============

Bug fixes
---------

 * When loading from saved states the shift was sometimes disabled only in the
 subsequent prime field leading to avoidable black-box probes. The shift will
 now be disabled in the correct prime field.

 * The parser interpreted some cases of `(+-x^(2*n))` as `+x^(2*n)`. This has
 been fixed. Binary operators were handled correctly.


FireFly 1.3.1
=============

New features
------------

 * When saving the states of reconstruction objects is enabled, every 30 minutes
 all probes which have been calculated are now written to files in the
 `ff_save/probes` directory. Starting from saved states will also read in all
 saved probes and resume the reconstruction from this point. Therefore, one does
 not have to restart from the beginning of the prime field after a crash.

Changes
-------

 * The states of reconstruction objects are now compressed using the `zlib`
 library.

 * Added a new member function for the `Reconstructor` class which reads in a
 whole directory of saved states of reconstruction objects. It can be called
 with `resume_from_saved_state()` when the directory `./ff_save` exist.

 * Added unit tests which check different reconstruction modes. They can be
 executed by calling `make test` in the build directory.

 * Added an implementation of the Xoshiro256** PRNG which is partly used for the
 generation of pseudo random numbers.

 * Minor performance and memory improvements.

Bug fixes
---------

 * Fixed a rare singular-system error which was caused by the sequence of random
 numbers generated by the pcg32 algorithm containing the same number twice. We
 now check the sequences for duplicates and omit them. Thanks to Long Chen for
 providing an example which could be used for finding this error.

 * Fixed a crash with `Nothing left to feed.` which was caused by queuing not
 enough probes in the safe mode with bunch sizes larger than 1.


FireFly 1.3.0
=============

New features
------------

 * Introduced a bunched evaluation of the black box. In addition to the
 `operator()` of `BlackBoxBase` which returns a vector of FFInt, a probe, there
 is now an `operator()` which returns a vector of a vector of FFInt, a vector of
 probes. The default implementation just calls the normal operator several
 times. This feature can help improving the runtime when reaching CPU limits if
 the user can provide an `operator()` which reduces the overhead when it
 computes several probes at once. However, additional threads are always
 preferable to larger bunch sizes.

 * Added a bunched evaluation of parsed functions to the `ShuntingYardParser`.
 It can slightly improve the runtime for large functions.

Changes
-------

 * Changes to the `ShuntingYardParser`:
   - The parsable format changed slightly. The delimiter to mark the end of
   functions `\n` has been replaced by `;`. Spaces and new lines occurring in
   expressions will be removed automatically.

   - The parser now supports unary operators for parentheses. We thank Robert
   Schabinger for this suggestion.

   - The parser now supports negative exponents like `(x+y)^(-10)`. A negative
   exponent has to be used with parentheses.

   - The parser now supports capital letters for variables.

   - The parser now performs a validation of the input by removing white spaces,
   checking parentheses, removing redundant parentheses, and transforming `+-`
   or `-+` to `-`.

 * Without the safe mode, all required probes are now scheduled when changing a
 prime field. This leads to runtime improvements when more than one prime is
 needed.

 * Changed recursive implementation of Thiele and Newton interpolation to
 an iterative one which avoids stack overflows.

 * Added more information to the info messages of the `Reconstructor` class and
 changed them a bit.

 * The safe mode can now handle denominators of monomial coefficients which
 are the prime numbers used for the interpolation.

 * Added a check for the GMP version.

Bug fixes
---------

 * Fixed a rare crash of the `Reconstructor` with `No items to feed anymore`.

 * Fixed another rare crash of the `Reconstructor` with `No items to feed
 anymore`. We thank Mario Prausa for noticing.

 * Fixed 1/0 cases for development versions of FLINT.

 * Fixed the string type for the Intel icpc compiler.


FireFly 1.2.1
=============

Bug fixes
---------

 * Fixed a minor oversampling which occurred in some cases.

 * The `ShuntingYardParser` could parse functions wrongly if the variables
 coincided with internal variables (a,b,c,...,z) which were used for
 replacements. Now, only the user-defined variables are parsed without replacing
 them. We thank Robert Schabinger for noticing.


FireFly 1.2.0
=============

Changes
-------

 * FireFly is now performing a dense-sparse-hybrid approach during the
 interpolation.
 We try to find a sparse shift and then interpolate the rational function densely
 including this shift. When the current highest degree (of either numerator or
 denominator) is fully interpolated, we check if we can use this result to
 interpolate lower degrees sparsely by starting their interpolation again and
 numerically subtracting the effects of the shift if their dense interpolation
 has not finished yet.
 Already (densely or sparsely) interpolated polynomials are removed from the
 homogenized system of equations in `t`.
 Thus, we need the maximal possible number of terms of the rational function
 as black-box probes in the worst case while also utilizing the sparsity of a
 function to some extent. In the average case, this should lead to a drastic
 reduction of the required black-box probes and an overall reduced runtime.

 * When we need a shift in additional prime fields (not in the safe mode), we
 also perform a hybrid approach which first checks which polynomial has the
 maximal number of terms. This polynomial will be calculated sparsely. All
 polynomials with fewer or equal terms than the maximal number (including terms
 generated by a shift) are calculated densely. Polynomials with more terms than
 the maximal number, including terms generated by a shift, are calculated
 sparsely.
 In general, this leads to fewer required black-box probes than a dense approach
 while minimizing the oversampling when a sparse shift is found.

 * `BlackBoxBase` now has a virtual destructor. We thank Philipp Maierhoefer for
 this suggestion.

 * `prime_changed()` in `BlackBoxBase` now has a default implementation which
 does nothing instead of requiring the user to define it. We thank Mario Prausa
 for this suggestion.

 * `enable_scan()` in the safe mode now just throws a warning instead of exiting
 the program. We thank Mario Prausa for this suggestion.

Bug fixes
---------

 * The `Reconstructor` class now has a destructor which deletes all dynamically
 allocated memory.

 * The safe mode is usable again. We thank Mario Prausa for noticing the
 problems.

 * If the number of variables was set to 1 and the black box was just a constant,
 the interpolation failed. This has been fixed and constants for one variable
 can be interpolated again. We thank Mario Prausa for noticing.

 * The `ShuntingYardParser` could not parse negative variables. This has been fixed.

 * The `ShuntingYardParser` could not handle global signs. This has been fixed.

 * Fixed a deadlock when starting from a saved state.

 * `set_tags()` and `resume_from_saved_state()` now work more consistently.

 * `-lflint` is only added to the pkgconfig file when FLINT is actually used.


FireFly 1.1.1
=============

Bug fixes
---------

 * The `Reconstructor` class can reconstruct zeros again.


FireFly 1.1.0
=============

New features
------------
 * Added Ben-Or/Tiwari sparse univariate polynomial interpolation algorithm
 and combined it with the dense Newton interpolation algorithm to a
 racing algorithm during Zippel's algorithm. This reduces the number of
 black-box probes for sparse multivariate polynomials significantly.
 Thanks to Sven Yannick Klein.

 * During the interpolation of the univariate rational auxiliary functions
 constants in numerator or denominator which are not used for normalization
 are removed from the systems of equations to reduce the number of black-box
 probes.

 * Added a "safe mode" which interpolates the black box from scratch over
 each prime field to be sensitive to unlucky primes, zeros, and other
 errors. It can be used by calling the member function `set_safe_interpolation()`
 of the `Reconstructor` class.

 * The black box is no longer a function of `Reconstructor` but instead a functor.
 `source/include/Reconstructor.hpp` contains the base class `BlackBoxBase`.
 The user has to define his black box as a derived class and provide a constructor,
 the evaluation `std::vector<FFInt> operator()(const std::vector<FFInt>& values)`,
 and the function `void prime_changed()` which allows the user to change class
 variables when the prime field changes. `Reconstructor` has to be initialized with
 a reference to the black box. The example class `BlackBoxUser` can be found in
 `example.cpp`

 * Added a script which converts a list of functions in Mathematica syntax
 to compilable C++ code to perform interpolations with them. This can be
 helpful for arithmetic with functions with many terms where other programs
 fail. The script can be found in the `mma_2_ff` directory.

 * Added a shunting-yard parser to parse a collection of rational functions
 for functional evaluation. This skips the compilation steps of the Mathematica
 to C++ conversion script.

 * Added a Horner representation of rational functions which may result in
 faster evaluation times when needed. Check out `source/include/HornerGenerator.hpp`
 and the new member functions of `RationalFunctions` and `Polynomial`, respectively.

 * Added dense algorithms for matrix manipulation, e.g., computing the inverse,
 the determinant, or the solution of a system of equations. Additionally,
 LU decompositions are supported. Further information can be found in
 `source/include/DenseSolver.hpp`.

Changes
-------

 * Generate 64-bit anchor points and shifts instead of 32-bit.

 * Many small runtime improvements and minor bug fixes.

 * Discard prime fields over which the black box evaluates to zero in the first
 probe. This makes the code safer regarding unlucky primes and zeros.

Bug fixes
---------

 * When the member function `to_string` of the `RationalFunction` class was called
 on a zero polynomial an error was thrown which was actually not an error. Thanks
 to Long Chen.


FireFly 1.0.0
=============

This is the initial release of the FireFly library. FireFly interpolates rational
functions over finite (prime) fields Z_p.
